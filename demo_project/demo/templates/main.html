<!DOCTYPE html>
{% load staticfiles %}
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.jsdelivr.net/npm/table-dragger@1.0.2/dist/table-dragger.min.js"></script>
    <title>BackTrack System</title>

    <!-- load stylesheets -->
    <link rel="stylesheet" href="{% static 'bootstrap.min.css' %}">                                      <!-- Bootstrap style -->
    <link rel="stylesheet" href="{% static 'magnific-popup.css' %}">                                <!-- Magnific pop up style, http://dimsemenov.com/plugins/magnific-popup/ -->
    <link rel="stylesheet" href="{% static 'main-style.css' %}">

</head>
    <body>
        <div class="container">
            <div class="row">
                <div class="tm-left-right-container">
                    <div class="tm-blue-bg tm-left-column">
                        <div class="tm-logo-div text-xs-center">
                            <h1 class="tm-site-name">PENDRAGON</h1>
                        </div>
                        <nav class="tm-main-nav">
                            <ul class="tm-main-nav-ul">
                                <li class="tm-nav-item">
                                    <a href="#productbacklog" class="tm-nav-item-link">Product Backlog</a>
                                </li>
                                <li class="tm-nav-item">
                                    <a href="#sprintbacklog" class="tm-nav-item-link">Sprint Backlog</a>
                                </li>
                            </ul>
                        </nav>
                    </div> <!-- Left column: logo and menu -->

                    <!-- Right column: content -->
                    <div class="tm-right-column">
                        <div class="tm-content-div">
                            <!-- Product Backlog section -->
                            <section id="productbacklog" class="tm-section">
                                <header>
                                    <h1 class="tm-blue-text tm-welcome-title tm-margin-b-45">Product Backlog</h1>
                                </header>
                                <form>
                                  <label>STATUS: </label>
                                  <select id="mylist" onchange="myFunction()" class='form-control'>
                                  <option selected></option>
                                  <option>FINISHED</option>
                                  <option>IN PROGRESS</option>
                                  <option>NOT YET STARTED</option>
                                  </select>

                                  <table id="myTable" width=100% border="1">
                                      <thead>
　                                    <tr>
　                                    <th class='handle'>Title</th>
                                    　<th class='handle'>Description</th>
                                      <th class='handle'>Priority</th>
                                      <th class='handle'>Status</th>
                                      <th class='handle'>Estimated StoryPt</th>
                                    　</tr>
                                  </thead>
                                    {% for p in pbi_list %}
                                    <tbody>
                                    <tr>
                                      <td><a class="btn btn-primary" href="./{{p.title}}">{{p.title}}</a></td>
                                      <td>{{p.description}}</td>
                                      <td>{{p.priority}}</td>
                                      <td>{{p.status}}</td>
                                      <td>{{p.storyPt}}</td>
                                    </tr>
                                  </tbody>
                                    {% empty %}
                                    <tr>
                                      <td colspan="5">There is no pbi in the project.</td>
                                    </tr>
                                    {% endfor %}

                                  </table>
                                  <br>
                                <input class="button" type="button" onclick="location.href='./createPbi'" value="Create"><br><br>

                                </form>
                            </section>



                            <!-- Current View section -->
                            <section id="sprintbacklog" class="tm-section">
                                <div class="row">
                                    <div class="col-lg-8 col-md-7 col-sm-12 col-xs-12 push-lg-4 push-md-5">
                                        <header>
                                            <h1 class="tm-blue-text tm-welcome-title tm-margin-b-45">Sprint Backlog</h1>
                                        </header>
                                        <table width=150% border="1">
　                                          <tr>
　                                          <th>pbi</th>
                                          　<th class="col1">task - in progress</th>
                                            <th class="col2">task - not yet started</th>
                                            <th class="col3">task - finished</th>
                                          　</tr>
                                          {% for p in pbi_list %}
                                          <tr>
                                            <td>{{p.title}}</td>
                                            <td class="col1"></td>
                                            <td class="col2"></td>
                                            <td class="col3"></td>
                                          </tr>
                                          {% empty %}
                                          <tr>
                                            <td colspan="4">There is no pbi in the project.</td>
                                          </tr>
                                          {% endfor %}

                                        </table>
                                        <br>
                                        <input class="button" type="button" onclick="location.href='./createtask'" value="Add task"><br><br>
                                        <input type="button" id="hideCol1" value="Hide Finished" />
                                        <input type="button" id="hideCol2" value="Hide In Progess" />
                                        <input type="button" id="hideCol3" value="Hide Not Yet Started" />
                                        <input type="button" id="showAll" value="ShowAll" />
                                    </div>


                                </div>
                            </section>

                            <footer>
                                <p class="tm-copyright-p">Copyright &copy; <span class="tm-current-year">2019</span> Zebra</p>
                            </footer>
                        </div>

                    </div> <!-- Right column: content -->
                </div>
            </div> <!-- row -->
        </div> <!-- container -->

        <script>

          var el = document.getElementById('myTable');
          var dragger = tableDragger(el,{
           mode: 'row',
          dragHandler: '',
          onlyBody: true,
          animation: 300
          });

          dragger.on('drop',function(from, to){
          console(from);
          console(to);
          });

        function myFunction() {
          // Declare variables
          var input, filter, table, tr, td, i, txtValue;
          input = document.getElementById("mylist");
          filter = input.value.toUpperCase();
          table = document.getElementById("myTable");
          tr = table.getElementsByTagName("tr");

          // Loop through all table rows, and hide those who don't match the search query
          for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[2];
            if (td) {
              txtValue = td.textContent || td.innerText;
              if (txtValue.toUpperCase().indexOf(filter) > -1) {
                tr[i].style.display = "";
              } else {
                tr[i].style.display = "none";
              }
            }
          }
        }

        var hideCol1 = function () {
            var e = document.getElementsByClassName("col1");
            for (var i = 0; i < e.length; i++) {
                e[i].style.display = "none";
            }
        };

        var hideCol2 = function () {
            var e = document.getElementsByClassName("col2");
            for (var i = 0; i < e.length; i++) {
                e[i].style.display = "none";
            }
        };
        var hideCol3 = function () {
          var e = document.getElementsByClassName("col3");
          for (var i = 0; i < e.length; i++) {
              e[i].style.display = "none";
          }
      };

        var showAll = function () {
            var e = document.getElementsByClassName("col1");
            for (var i = 0; i < e.length; i++) {
                e[i].style.display = "table-cell";
            };
            e = document.getElementsByClassName("col2");
            for (var i = 0; i < e.length; i++) {
                e[i].style.display = "table-cell";
            };
            e = document.getElementsByClassName("col3");
            for (var i = 0; i < e.length; i++) {
                e[i].style.display = "table-cell";
            };
        };

        (function () {
            document.getElementById("hideCol1").addEventListener("click", hideCol1);
            document.getElementById("hideCol2").addEventListener("click", hideCol2);
            document.getElementById("hideCol3").addEventListener("click", hideCol3);
            document.getElementById("showAll").addEventListener("click", showAll);
        })();

        </script>
</body>
</html>
